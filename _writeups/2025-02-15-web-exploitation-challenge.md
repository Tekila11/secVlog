---
layout: writeup
title: "Web Exploitation Challenge: Cookie Monster"
date: 2025-02-15
categories: web-exploitation
tags: [web, cookies, authentication, ctf]
difficulty: Medium
points: 500
event: "Example CTF 2025"
---

## Challenge Description
The website uses a cookie-based authentication system. Your goal is to gain admin access to the dashboard.

## Initial Analysis
Upon inspecting the cookies, I noticed a suspicious cookie named `role` with an encoded value.

## Solution Steps

### 1. Cookie Analysis
```javascript
// Original cookie
role=dXNlcg==

// Decoded value (base64)
// user
```

### 2. Exploitation
1. Decoded the base64 cookie value
2. Changed "user" to "admin"
3. Re-encoded in base64
4. Replaced the cookie value

```python
import base64

# Encode new value
new_role = base64.b64encode(b"admin").decode()
print(f"New cookie value: {new_role}")
# Output: YWRtaW4=
```

### 3. Result
After replacing the cookie value, refreshing the page granted admin access.

## Tools Used
- Python base64 library
- Browser Developer Tools

## Flag
`flag{c00k1e_m0nst3r_1s_s4t1sf13d}`

## Lessons Learned
- Always check for basic encoding schemes
- Cookie manipulation can lead to privilege escalation
- Input validation should be performed server-side